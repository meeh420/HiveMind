{"definition_id":"2dba755e-74df-4642-919d-9dd4a5624629","last_refresh_timestamp":1392997642311,"postexecution_handlers":[],"definition":{"id":"2dba755e-74df-4642-919d-9dd4a5624629","code":"import java.util.Map;\n\nif(crudzilla_datastatement_datasource_config.type.compareTo(\"jndi\") == 0){\n  \tjavax.naming.Context initContext = new javax.naming.InitialContext();\n  \tjavax.sql.DataSource dataSource = (javax.sql.DataSource)initContext.lookup(/*\"java:comp/env/\"+*/crudzilla_datastatement_datasource_config.jndiPath);\n  \treturn dataSource.getConnection();\n}\nelse\nif(crudzilla_datastatement_datasource_config.type.compareTo(\"datasource-bean\") == 0){\n  \tjava.lang.Object dataSourceBean = java.lang.Class.forName(crudzilla_datastatement_datasource_config.className).newInstance();\n  \torg.apache.commons.beanutils.BeanUtilsBean.getInstance().populate(dataSourceBean,crudzilla_datastatement_datasource_config.dataSource);\n  \treturn ((javax.sql.DataSource)dataSourceBean).getConnection();\n}\nelse\nif(crudzilla_datastatement_datasource_config.type.compareTo(\"jdbc-driver\") == 0){\n    //load driver if necessary\n    if(crudzilla_datastatement_datasource_config.driverClassName != null && !crudzilla_datastatement_datasource_config.driverClassName.isEmpty())\n          Class.forName(crudzilla_datastatement_datasource_config.driverClassName);    \n    \n\tjava.util.Properties connectionProps = new java.util.Properties();\n    if(crudzilla_datastatement_datasource_config instanceof org.apache.commons.beanutils.LazyDynaBean){\n        for (Map.Entry<String, Object> entry : crudzilla_datastatement_datasource_config.getMap().entrySet()) { \n          String key = entry.getKey();\n          Object value = entry.getValue();\n          connectionProps.put(key, value);\n        }\n    }\n    else\n    {  \t\n      if(crudzilla_datastatement_datasource_config.userName != null && !crudzilla_datastatement_datasource_config.userName.isEmpty())\n          connectionProps.put(\"user\", crudzilla_datastatement_datasource_config.userName);\n      \n      if(crudzilla_datastatement_datasource_config.passWord != null && !crudzilla_datastatement_datasource_config.passWord.isEmpty())\n      \tconnectionProps.put(\"password\", crudzilla_datastatement_datasource_config.passWord);       \n    }\n    return java.sql.DriverManager.getConnection(crudzilla_datastatement_datasource_config.url,connectionProps);\n}\nreturn null;","name":"datasource-connection-creator","description":"","crudType":"scriptexecutor","type":"groovy","serverSideOnly":"yes","requireAllIdentities":null,"lastModifiedTimeStamp":"1392997638762"},"preexecution_handlers":[],"execution_parameters":[],"reference_id":"dfc740ad-05a1-40ba-b8b0-f2f93a770d90","accesscontrols":[]}