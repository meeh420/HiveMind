{"definition_id":"a314742f-9026-40ae-9b24-b0086bf2307d","last_refresh_timestamp":1392425440546,"postexecution_handlers":[],"definition":{"id":"a314742f-9026-40ae-9b24-b0086bf2307d","code":"import java.util.Map;\nimport java.util.HashMap;\nimport com.crudzilla.platform.util.CrudzillaUtil;\nimport java.io.File;\nimport org.apache.commons.io.FileUtils;\n\nMap returnVal = new HashMap();\nString fromRelPath = fromRelPath;\nString toRelPath   = toRelPath;\n\nString newRelPath = toRelPath+\"/\"+fromRelPath.split(\"/\")[fromRelPath.split(\"/\").length-1];\n\njava.io.File moveToDestParent = CrudzillaUtil.getFile(crudzilla,toRelPath);\njava.io.File fileToMove       = CrudzillaUtil.getFile(crudzilla,fromRelPath);\njava.io.File moveToDest       = CrudzillaUtil.getFile(crudzilla,newRelPath);\n\n//don't support overwrite\nif(moveToDestParent.isDirectory() && !moveToDest.exists()){\n  try{\n    \n    newRelPath = new File(newRelPath).getCanonicalPath();\n    \n    if(fileToMove.isFile())\n      FileUtils.copyFileToDirectory(fileToMove, moveToDestParent, false);\n    else\n      FileUtils.copyDirectoryToDirectory(fileToMove, moveToDestParent);\n    \n    //**this.sync(AssetFSManager.SYNC_ACTION_UPDATE,newRelPath);\n    \n    returnVal.put(\"status\", \"success\");\n    returnVal.put(\"relPath\", newRelPath);\n    return returnVal;\n  }catch(java.io.IOException ex){\n    crud.logger().error(ex);\n  }\n}\nreturnVal.put(\"status\", \"error\");\nreturn returnVal;","name":"paste","description":"","crudType":"scriptexecutor","type":"groovy","serverSideOnly":"no","requireAllIdentities":"no","lastModifiedTimeStamp":"1392425439634"},"preexecution_handlers":[],"execution_parameters":[],"reference_id":"a7503807-2b67-4871-8c02-37e5b6b59a9a","accesscontrols":[]}