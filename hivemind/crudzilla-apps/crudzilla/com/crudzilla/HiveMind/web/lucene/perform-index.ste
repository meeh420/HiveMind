{"definition_id":"b03b9796-48bd-4d94-a7d0-7fdc3e120e6a","last_refresh_timestamp":1385149495886,"postexecution_handlers":[],"definition":{"id":"b03b9796-48bd-4d94-a7d0-7fdc3e120e6a","code":"import java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.io.File;\nimport net.sf.json.JSONObject;\nimport org.apache.commons.io.FileUtils;\nimport net.sf.json.JSONArray;\nimport net.sf.json.JSONNull;\nimport net.sf.json.JSONObject;\nimport java.util.Iterator;\nimport org.apache.commons.io.filefilter.FileFilterUtils;\nimport org.apache.commons.io.filefilter.HiddenFileFilter;\nimport org.apache.commons.io.filefilter.IOFileFilter;\nimport org.apache.lucene.index.IndexWriterConfig;\nimport org.apache.lucene.index.IndexWriter;\nimport org.apache.lucene.analysis.Analyzer;\nimport org.apache.lucene.analysis.standard.StandardAnalyzer;\nimport org.apache.lucene.util.Version;\nimport org.apache.lucene.store.RAMDirectory;\nimport org.apache.lucene.store.Directory;\nimport org.apache.lucene.store.FSDirectory;\nimport org.apache.lucene.index.DirectoryReader;\nimport org.apache.lucene.search.IndexSearcher;\nimport org.apache.lucene.analysis.util.CharArraySet;\n\ndef runCrud() {\n    String assetBaseDir = (new File(crud.appBaseDir()+\"/\"+crudzilla.sysSettings().get(\"crudzilla_asset_base\")).getCanonicalPath());\n  \n    Analyzer analyzer = new StandardAnalyzer(Version.LUCENE_CURRENT,new CharArraySet(Version.LUCENE_CURRENT,0,false));\n \n    //((StandardAnalyzer)analyzer).getStopwordSet().clear();\n    //CharArraySet noStopwords = CharArraySet.copy(Version.LUCENE_CURRENT,((StandardAnalyzer)analyzer).getStopwordSet());\n    // Store the index in memory:\n    //Directory directory = new RAMDirectory();\n    // To store an index on disk, use this instead:\n    Directory directory = FSDirectory.open(new File(assetBaseDir+\"/lucene-index\"));\n    IndexWriterConfig config = new IndexWriterConfig(Version.LUCENE_CURRENT, analyzer);\n    IndexWriter iwriter = new IndexWriter(directory, config);\n  \n    Object ext2Mime = crud.call(\"../editor-mode-definitions/codemirror-editor-ext2modes.ins\");\n    String[] includedExts = crud.call(\"config.ins\").get(\"include_extensions\").toString().split(\",\");\n  \n  \tcrud.add(\"directory\",directory)\n    .add(\"ext2Mime\",ext2Mime)\n    .add(\"includedExts\",includedExts)\n  \t.add(\"iwriter\",iwriter).add(\"relPath\",relPath)    \n  \t.call(\"index-directory.ste\");\n  \n    iwriter.close();  \n    directory.close();\n}\n\nrunCrud();\n\n","name":"perform-index","description":"","crudType":"scriptexecutor","type":"groovy","serverSideOnly":"no","requireAllIdentities":"no","lastModifiedTimeStamp":"1385149493288"},"preexecution_handlers":[],"execution_parameters":[],"reference_id":"db06a9d9-861e-4829-82ce-ed002e61e1d2","accesscontrols":[]}