{"definition_id":"99e106f5-da28-412f-a156-7661d272152c","last_refresh_timestamp":1391053693548,"postexecution_handlers":[],"definition":{"id":"99e106f5-da28-412f-a156-7661d272152c","code":"\nString assetBaseDir = (new File(crud.appBaseDir()+\"/\"+crudzilla.sysSettings().get(\"crudzilla_asset_base\")).getCanonicalPath());\nString destDir = assetBaseDir;\n\nObject partStoreProxy = crud.call(\"/crudzilla-app-settings/crudzilla-http-proxy.ins\");\n\n\n\nString downloadUrl = partStoreProxy.targetUri+\"/remote-install\"+partPath+\"?access_token=\"+\n  crud.call(\"/user-identity/get-part-store-access-token.stm\").part_store_access_token;\n\n\nList apps = crud.call(\"/new-web-app/app-list/apps.ins\");\n\nfor(Object app:apps){\n  if(appPath.startsWith(app.baseDir)){\n    destDir = destDir+\"/\"+app.baseDir+\"/crudzilla-parts\";\n    break;\n  }\n}\n\n//download the part\nreturn crud.add(\"destDir\",destDir)\n\t\t  .add(\"download\",\"true\")\n\t\t  .add(\"url\",downloadUrl)\n\t\t  .call(\"download-part.svc\");","name":"install","description":"","crudType":"scriptexecutor","type":"groovy","serverSideOnly":"no","requireAllIdentities":"no","lastModifiedTimeStamp":"1391053690607"},"preexecution_handlers":[],"execution_parameters":[],"reference_id":"d2fcd615-450e-447b-b04e-50f1fa30ce8f","accesscontrols":[]}