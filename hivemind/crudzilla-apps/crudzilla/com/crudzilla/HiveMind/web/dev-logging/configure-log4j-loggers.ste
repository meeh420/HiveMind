{"definition_id":"880cc247-c261-4a12-84f3-7f68ee04b79f","last_refresh_timestamp":1382373971451,"postexecution_handlers":[],"definition":{"id":"880cc247-c261-4a12-84f3-7f68ee04b79f","code":"import java.io.StringWriter;\nimport org.apache.log4j.Logger;\nimport org.apache.log4j.Level;\nimport org.apache.log4j.WriterAppender;\nimport org.apache.log4j.PatternLayout;\n\nif(crudzilla.sysSettings().get(\"loggerStringWriter\") == null || reload.compareTo(\"true\") == 0){\n  Object loggerConfig = crud.call(loggerConfigPath);\n\n  StringWriter consoleWriter = new StringWriter();\n  WriterAppender appender = new WriterAppender(new PatternLayout(loggerConfig.pattern),consoleWriter);\n  appender.setName(loggerConfig.name);\n\n  if(loggerConfig.level.compareToIgnoreCase(\"ALL\") == 0)\n  \tappender.setThreshold(org.apache.log4j.Level.ALL);\n  else\n  if(loggerConfig.level.compareToIgnoreCase(\"DEBUG\") == 0)\n    appender.setThreshold(org.apache.log4j.Level.DEBUG); \n  else\n  if(loggerConfig.level.compareToIgnoreCase(\"INFO\") == 0)\n    appender.setThreshold(org.apache.log4j.Level.INFO);\n  else\n  if(loggerConfig.level.compareToIgnoreCase(\"ERROR\") == 0)\n    appender.setThreshold(org.apache.log4j.Level.ERROR);\n  else\n  if(loggerConfig.level.compareToIgnoreCase(\"TRACE\") == 0)\n    appender.setThreshold(org.apache.log4j.Level.TRACE);\n  else\n  if(loggerConfig.level.compareToIgnoreCase(\"OFF\") == 0)\n    appender.setThreshold(org.apache.log4j.Level.OFF);\n  else\n  if(loggerConfig.level.compareToIgnoreCase(\"WARN\") == 0)\n    appender.setThreshold(org.apache.log4j.Level.WARN);\n  else\n  if(loggerConfig.level.compareToIgnoreCase(\"ERROR\") == 0)\n    appender.setThreshold(org.apache.log4j.Level.ERROR); \n\n  crudzilla.sysSettings().set(\"loggerStringWriter\",consoleWriter);\n  \n  for(Object loggerClass:loggerConfig.classes){\n    try\n    {\n      \tif(loggerClass.className != null && !loggerClass.className.isEmpty())\n      \t\tLogger.getLogger(Class.forName(loggerClass.className)).addAppender(appender);\n        else\n        if(loggerClass.name != null && !loggerClass.name.isEmpty()){\n            Logger logger = Logger.getLogger(loggerClass.name);\n            logger.addAppender(appender);\n            logger.setLevel(org.apache.log4j.Level.DEBUG);\n        }\n      \n    }catch(Exception ex){\n      crud.logger().info(\"Error configuring CWAB appender for logger \",ex);\n    }\n  }\n}","name":"configure-log4j-loggers","description":"","crudType":"scriptexecutor","type":"groovy","serverSideOnly":"no","requireAllIdentities":null,"lastModifiedTimeStamp":"1382373970376"},"preexecution_handlers":[],"execution_parameters":[{"id":"fbd9581d-3595-43dd-a880-693026bebf60","definitionId":"880cc247-c261-4a12-84f3-7f68ee04b79f","required":"no","name":"loggerConfigPath","type":"crud","validationRegEx":"","defaultValue":"config.ins","maxLength":"","minLength":"","lineEndLength":"","maxRange":"","minRange":"","dateFormat":"","dateFormatStrict":"no","allowallschemesForURL":"no","allow2slashesForURL":"no","nofragmentsForURL":"no","schemesForURL":"","evalLeft":"no","evalRight":"no","keepAliveCount":"","isFinal":"yes","position":"0"},{"id":"eb49c284-543f-4e71-a7d3-7308c8a004db","definitionId":"880cc247-c261-4a12-84f3-7f68ee04b79f","required":"no","name":"reload","type":"string","validationRegEx":"","defaultValue":"false","maxLength":"","minLength":"","lineEndLength":"","maxRange":"","minRange":"","dateFormat":"","dateFormatStrict":"no","allowallschemesForURL":"no","allow2slashesForURL":"no","nofragmentsForURL":"no","schemesForURL":"","evalLeft":"no","evalRight":"no","keepAliveCount":null,"isFinal":"no","position":"1"}],"reference_id":"7b507516-6628-46f3-b459-557cdd858487","accesscontrols":[]}