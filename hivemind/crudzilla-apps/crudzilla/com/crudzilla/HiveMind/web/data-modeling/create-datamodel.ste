{"definition_id":"bfa3b7f4-624b-499f-b326-16e0d13ed7f1","last_refresh_timestamp":1400892771340,"postexecution_handlers":[],"definition":{"id":"bfa3b7f4-624b-499f-b326-16e0d13ed7f1","code":"\n//create datamodel category\nObject dataModelTaxonomy = crud.add(\"createPath\",\"true\")\n\t.add(\"taxonomyPath\",relPath+\"/\"+dataModelName)\n\t.call(findAppTaxonomy);\n\n\n//get datamodel template object\nObject dataModelTemplateTaxonomy = \ncrud\n.add(\"taxonomyPath\", \"/com/crudzilla/HiveMind/web/column-pooling/datamodel-type-template\")\n.call(findAppTaxonomy);\n\n\n\n//create datamodel object\n\nString dataModelId = crud\n.add(\"definition_id\",dataModelTemplateTaxonomy.linkId)\n.add(\"name\",\"datamodel\")\n.add(\"crudzilla_name_value\",dataModelName)\n.add(\"crudzilla_alias_value\",dataModelAlias)\n.add(\"crudzilla_dataTable_value\",dataModelDataTable)\n.add(\"crudzilla_typeIdentifier_value\",dataModelIdentifier)\n.call(cloneCrudDefinition);\n\ncrud\n  .add(\"apptaxonomy_id\",dataModelTaxonomy.appTaxonomyId)\n  .add(\"parent_id\",dataModelTaxonomy.id)\n  .add(\"presibling_id\",\"-1\")\n  .add(\"link_id\",dataModelId)\n  .add(\"link_apptaxonomy_id\",\"-1\")\n  .add(\"type\",\"instantiator\")\n  .add(\"name\",\"datamodel\")\n  .call(addAppTaxonomy);\n\n\n\n//create fields category\nObject fieldsTaxonomy = crud.add(\"createPath\",\"true\")\n\t.add(\"taxonomyPath\",relPath+\"/\"+dataModelName+\"/fields\")\n\t.call(findAppTaxonomy);\n\n//create the fields list\nObject fieldListId = crud.add(\"name\",\"fields\").call(addInstantiator);\ncrud\n  .add(\"apptaxonomy_id\",dataModelTaxonomy.appTaxonomyId)\n  .add(\"parent_id\",dataModelTaxonomy.id)\n  .add(\"presibling_id\",\"-1\")\n  .add(\"link_id\",fieldListId)\n  .add(\"link_apptaxonomy_id\",\"-1\")\n  .add(\"type\",\"instantiator\")\n  .add(\"name\",\"fields\")\n  .call(addAppTaxonomy);\n\n\nfor(int i=0;i<fieldCount;i++){\n  \n  String dataModelFieldId = crud\n  //.add(\"definition_id\",dataModelFieldTemplateTaxonomy.linkId)\n  .add(\"name\",arguments.get(\"dataModelField\"+i))\n  .add(\"name\",arguments.get(\"dataModelField\"+i))\n  .add(\"column\",arguments.get(\"dataModelFieldColumn\"+i))\n  .add(\"useAsLabel\",arguments.get(\"dataModelFieldUseAsLabel\"+i))\n  .add(\"relPath\",relPath+\"/\"+dataModelName)\n  .call(\"add-field.ste\");\n}\n\n//bake the datamodel\ncrud.add(\"relPath\",relPath+\"/\"+dataModelName).call(\"/taxonomy/bake-crud.ste\");\n\nMap result = new HashMap();\nresult.put(\"dataModelId\",dataModelId);\nresult.put(\"dataModelTaxonomyId\", dataModelTaxonomy.id);\n\nreturn result;","name":"create-datamodel","description":"","crudType":"scriptexecutor","type":"groovy","serverSideOnly":"no","requireAllIdentities":"no","lastModifiedTimeStamp":"1400892771106"},"preexecution_handlers":[],"execution_parameters":[{"id":"a1e9c85b-ffe7-40f3-8095-8fa6ee2bd36d","definitionId":"bfa3b7f4-624b-499f-b326-16e0d13ed7f1","required":"no","name":"cloneCrudDefinition","type":"string","validationRegEx":"","defaultValue":"../api/primary-execution/crud-definition/clone-crud-definition.stm","maxLength":"","minLength":"","lineEndLength":"","maxRange":"","minRange":"","dateFormat":"","dateFormatStrict":"no","allowallschemesForURL":"no","allow2slashesForURL":"no","nofragmentsForURL":"no","schemesForURL":"","evalLeft":"no","evalRight":"no","keepAliveCount":null,"isFinal":"yes","position":"0"},{"id":"f1b72a2a-0135-4e9d-872a-17c058a12406","definitionId":"bfa3b7f4-624b-499f-b326-16e0d13ed7f1","required":"no","name":"addAppTaxonomy","type":"string","validationRegEx":"","defaultValue":"../api/app-taxonomy/add-apptaxonomy.stm","maxLength":"","minLength":"","lineEndLength":"","maxRange":"","minRange":"","dateFormat":"","dateFormatStrict":"no","allowallschemesForURL":"no","allow2slashesForURL":"no","nofragmentsForURL":"no","schemesForURL":"","evalLeft":"no","evalRight":"no","keepAliveCount":null,"isFinal":"yes","position":"1"},{"id":"6eef7bc9-ef30-4598-a947-69df7c99c070","definitionId":"bfa3b7f4-624b-499f-b326-16e0d13ed7f1","required":"no","name":"findAppTaxonomy","type":"string","validationRegEx":"","defaultValue":"/taxonomy/find-category.ste","maxLength":"","minLength":"","lineEndLength":"","maxRange":"","minRange":"","dateFormat":"","dateFormatStrict":"no","allowallschemesForURL":"no","allow2slashesForURL":"no","nofragmentsForURL":"no","schemesForURL":"","evalLeft":"no","evalRight":"no","keepAliveCount":null,"isFinal":"yes","position":"2"},{"id":"8b5b328a-2f3b-4b91-9a90-4eb427854997","definitionId":"bfa3b7f4-624b-499f-b326-16e0d13ed7f1","required":"no","name":"addInstantiator","type":"string","validationRegEx":"","defaultValue":"/api/primary-execution/instantiator/add-instantiator.stm","maxLength":"","minLength":"","lineEndLength":"","maxRange":"","minRange":"","dateFormat":"","dateFormatStrict":"no","allowallschemesForURL":"no","allow2slashesForURL":"no","nofragmentsForURL":"no","schemesForURL":"","evalLeft":"no","evalRight":"no","keepAliveCount":null,"isFinal":"yes","position":"3"},{"id":"aadd2e6a-1132-492e-b03d-986eac928eed","definitionId":"bfa3b7f4-624b-499f-b326-16e0d13ed7f1","required":"no","name":"addParameter","type":"string","validationRegEx":"","defaultValue":"../api/nvp-processing/add-execution-parameter.stm","maxLength":"","minLength":"","lineEndLength":"","maxRange":"","minRange":"","dateFormat":"","dateFormatStrict":"no","allowallschemesForURL":"no","allow2slashesForURL":"no","nofragmentsForURL":"no","schemesForURL":"","evalLeft":"no","evalRight":"no","keepAliveCount":null,"isFinal":"yes","position":"4"},{"id":"20ab8bf3-41d5-40a3-9711-b8a34a2a13de","definitionId":"bfa3b7f4-624b-499f-b326-16e0d13ed7f1","required":"no","name":"fieldCount","type":"integer","validationRegEx":"","defaultValue":"","maxLength":"","minLength":"","lineEndLength":"","maxRange":"","minRange":"","dateFormat":"","dateFormatStrict":"no","allowallschemesForURL":"no","allow2slashesForURL":"no","nofragmentsForURL":"no","schemesForURL":"","evalLeft":"no","evalRight":"no","keepAliveCount":null,"isFinal":"no","position":"5"}],"reference_id":"825ffa20-4365-4b8e-b2d6-e0f751b340c3","accesscontrols":[]}