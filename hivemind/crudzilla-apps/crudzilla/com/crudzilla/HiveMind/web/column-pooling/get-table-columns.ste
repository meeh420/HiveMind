{"definition_id":"14371d53-1414-4e46-982b-2d4806c7a99f","last_refresh_timestamp":1378565040779,"postexecution_handlers":[],"definition":{"id":"14371d53-1414-4e46-982b-2d4806c7a99f","code":"import java.sql.ResultSet;\nimport java.sql.ResultSetMetaData;\nimport java.sql.SQLException;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport org.apache.commons.dbutils.QueryRunner;\nimport org.apache.commons.dbutils.ResultSetHandler;\nimport com.crudzilla.platform.Crudzilla;\n\nResultSetHandler resultSetHandler = new ResultSetHandler<Object>() {\n  \n  public Object handle(ResultSet rs) throws SQLException {\n    ResultSetMetaData meta = rs.getMetaData();\n    int cols = meta.getColumnCount();\n        \n    List columns = new ArrayList<String>();\n    for (int i = 0; i < cols; i++){\n        Map column = new HashMap();\n      \tcolumn.put(\"name\",meta.getColumnName(i+1));\n        column.put(\"type\",meta.getColumnTypeName(i+1));\n      \n      \tcolumns.add(column);\n    }\n    return columns;\n  }\n}; \n  \narguments.put(\"dataSourceConfig\",crud.call(dataTableDataSource,arguments));  \njava.sql.Connection conn = (java.sql.Connection)crud.call(\"\"+crudzilla.sysSettings().get(\"crudzilla_datasource_connection_creator\"), arguments);\nreturn new QueryRunner().query(conn,\"select * from \"+dataTable,resultSetHandler);","name":"get-table-columns","description":"","crudType":"scriptexecutor","type":"groovy","serverSideOnly":"no","requireAllIdentities":null,"lastModifiedTimeStamp":"1377111322414"},"preexecution_handlers":[],"execution_parameters":[],"reference_id":"c5b998c5-c90b-458a-a723-228446919387","accesscontrols":[]}